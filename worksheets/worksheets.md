The SQL Path: Printable Practice WorksheetsThese worksheets provide additional scenario-based exercises to reinforce your learning from "The SQL Path" book. They are designed to challenge you and help you combine concepts from different chapters. Solutions are provided at the end of each worksheet for self-assessment.Worksheet 1: Basic Querying Practice (Chapters 1-3)Instructions: Use the Databites e-commerce sample data. Write SQL queries to answer the following questions.Exercise 1.1: Customer Email List (Hypothetical)The marketing team is considering adding email addresses to the CUSTOMERS table. For now, they just need a combined list of first_name and last_name for all customers, displayed as a single full_name column.Objective: Retrieve a full_name for each customer (e.g., "Alice Smith").Your Query:SELECT
    CONCAT(first_name, ' ', last_name) AS full_name -- CONCAT for MySQL/PostgreSQL, || for PostgreSQL, + for SQL Server
FROM CUSTOMERS;
Solution 1.1:SELECT
    CONCAT(first_name, ' ', last_name) AS full_name -- CONCAT for MySQL/PostgreSQL, || for PostgreSQL, + for SQL Server
FROM CUSTOMERS;
Exercise 1.2: Budget Electronics InventoryThe purchasing team wants a quick list of all "Electronics" products that cost less than $50. Show their product_name and price, ordered from cheapest to most expensive.Objective: List budget electronics products.Your Query:-- Write your query here
Solution 1.2:SELECT
    product_name,
    price
FROM PRODUCTS
WHERE category = 'Electronics' AND price < 50
ORDER BY price ASC;
Exercise 1.3: Top 5 Recent OrdersThe operations manager wants to see the 5 most recent orders placed in the system, including all their details.Objective: Show the 5 most recent orders.Your Query:-- Write your query here
Solution 1.3:SELECT *
FROM ORDERS
ORDER BY order_date DESC
LIMIT 5; -- Or TOP 5 for SQL Server
Exercise 1.4: Formatted Customer Contact InfoThe customer service team needs a list of customers. For each customer, they want their full_name (as in Exercise 1.1) and a contact_id which combines the first letter of their first_name, the first two letters of their last_name, and their customer_id. For example, "Alice Smith" (customer_id 1) would have a contact_id of "ASm1". Order the results by full_name alphabetically.Objective: Retrieve full_name and a generated contact_id for each customer.Your Query:-- Write your query here
Solution 1.4:SELECT
    CONCAT(first_name, ' ', last_name) AS full_name,
    CONCAT(
        SUBSTRING(first_name, 1, 1),    -- First letter of first_name
        SUBSTRING(last_name, 1, 2),     -- First two letters of last_name
        customer_id                     -- Customer ID
    ) AS contact_id
FROM CUSTOMERS
ORDER BY full_name ASC;
-- Note: SUBSTRING function might be called SUBSTR in some SQL dialects (e.g., SQLite).
Worksheet 2: Aggregation & Joins Practice (Chapters 4-6)Instructions: Use the Databites e-commerce sample data. Write SQL queries to answer the following questions.Exercise 2.1: Total Revenue per CustomerThe finance department needs to know the total revenue generated by each customer.Objective: Calculate the total revenue (quantity * price) for each customer_id. Display customer_id and total_revenue, sorted by total_revenue in descending order.Your Query:-- Write your query here
Solution 2.1:SELECT
    C.customer_id,
    C.first_name,
    C.last_name,
    SUM(O.quantity * P.price) AS total_revenue
FROM CUSTOMERS AS C
INNER JOIN ORDERS AS O ON C.customer_id = O.customer_id
INNER JOIN PRODUCTS AS P ON O.product_id = P.product_id
GROUP BY C.customer_id, C.first_name, C.last_name
ORDER BY total_revenue DESC;
Exercise 2.2: Customers Who Bought Both Laptop and MonitorIdentify customers who have purchased both a 'Laptop' (product_id 1001) AND a 'Monitor' (product_id 1005).Objective: List the first_name and last_name of customers who have bought both a Laptop and a Monitor.Your Query:-- Write your query here
Solution 2.2:SELECT
    C.first_name,
    C.last_name
FROM CUSTOMERS AS C
WHERE C.customer_id IN (SELECT customer_id FROM ORDERS WHERE product_id = 1001)
AND C.customer_id IN (SELECT customer_id FROM ORDERS WHERE product_id = 1005);

-- Alternative using JOIN and GROUP BY:
/*
SELECT
    C.first_name,
    C.last_name
FROM CUSTOMERS AS C
INNER JOIN ORDERS AS O ON C.customer_id = O.customer_id
WHERE O.product_id IN (1001, 1005)
GROUP BY C.customer_id, C.first_name, C.last_name
HAVING COUNT(DISTINCT O.product_id) = 2;
*/
Exercise 2.3: Products Never Ordered in Quantity Greater Than 1Find all products that have been ordered, but never in a quantity greater than 1.Objective: List product_name and category for products that only appear in orders with quantity = 1.Your Query:-- Write your query here
Solution 2.3:SELECT
    P.product_name,
    P.category
FROM PRODUCTS AS P
WHERE P.product_id IN (SELECT DISTINCT product_id FROM ORDERS) -- Ensure it has been ordered at least once
AND P.product_id NOT IN (
    SELECT product_id
    FROM ORDERS
    WHERE quantity > 1
);
Worksheet 3: Advanced Techniques Practice (Chapters 7-9)Instructions: Use the Databites e-commerce sample data. Write SQL queries to answer the following questions.Exercise 3.1: Monthly Customer Acquisition RateTrack the cumulative number of customers acquired over time, month by month.Objective: For each signup_month (e.g., '2023-01'), show the count of new customers in that month and the running_total_customers acquired up to that month.Your Query:-- Write your query here
Solution 3.1:WITH MonthlySignups AS (
    SELECT
        DATE_FORMAT(signup_date, '%Y-%m') AS signup_month, -- Adjust date format function for your SQL dialect
        COUNT(customer_id) AS new_customers_in_month
    FROM CUSTOMERS
    GROUP BY signup_month
)
SELECT
    signup_month,
    new_customers_in_month,
    SUM(new_customers_in_month) OVER (ORDER BY signup_month ASC) AS running_total_customers
FROM MonthlySignups
ORDER BY signup_month ASC;
Exercise 3.2: Product Sales Performance Rating by Category (Enhanced)Categorize products within each category based on their total quantity sold relative to the average sales quantity for that category.Objective: For each product, show its product_name, category, total_quantity_sold, the category_average_quantity_sold, and a performance_rating:'Above Average' if total_quantity_sold is greater than category_average_quantity_sold'Below Average' if total_quantity_sold is less than category_average_quantity_sold'At Average' if total_quantity_sold is equal to category_average_quantity_soldYour Query:-- Write your query here
Solution 3.2:WITH ProductSales AS (
    SELECT
        P.product_id,
        P.product_name,
        P.category,
        SUM(O.quantity) AS total_quantity_sold
    FROM PRODUCTS AS P
    LEFT JOIN ORDERS AS O ON P.product_id = O.product_id
    GROUP BY P.product_id, P.product_name, P.category
)
SELECT
    PS.product_name,
    PS.category,
    PS.total_quantity_sold,
    AVG(PS.total_quantity_sold) OVER (PARTITION BY PS.category) AS category_average_quantity_sold,
    CASE
        WHEN PS.total_quantity_sold > AVG(PS.total_quantity_sold) OVER (PARTITION BY PS.category) THEN 'Above Average'
        WHEN PS.total_quantity_sold < AVG(PS.total_quantity_sold) OVER (PARTITION BY PS.category) THEN 'Below Average'
        WHEN PS.total_quantity_sold = AVG(PS.total_quantity_sold) OVER (PARTITION BY PS.category) THEN 'At Average'
        ELSE 'No Sales Data' -- For products with NULL total_quantity_sold (not ordered)
    END AS performance_rating
FROM ProductSales AS PS
ORDER BY PS.category, PS.total_quantity_sold DESC;
Exercise 3.3: First Order Product for Each CustomerDetermine which product was purchased in each customer's very first order.Objective: For each customer, list first_name, last_name, and the product_name of the item in their earliest order. If a customer placed multiple items in their first order, any one is fine.Your Query:-- Write your query here
Solution 3.3:WITH RankedOrders AS (
    SELECT
        O.customer_id,
        O.order_date,
        O.product_id,
        ROW_NUMBER() OVER (PARTITION BY O.customer_id ORDER BY O.order_date ASC, O.order_id ASC) AS rn -- Use order_id to break ties in order_date
    FROM ORDERS AS O
)
SELECT
    C.first_name,
    C.last_name,
    P.product_name AS first_order_product
FROM CUSTOMERS AS C
INNER JOIN RankedOrders AS RO ON C.customer_id = RO.customer_id
INNER JOIN PRODUCTS AS P ON RO.product_id = P.product_id
WHERE RO.rn = 1;
